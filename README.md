# Локальный ТТС сервер для СС13
Поддержвиваемые провайдеры:
- Silero

## Установка

Клонируйте репозиторий

Воспользуйтесь в командной строке, открытой в папке tools\ttsServer: `pip install -r requirements.txt`
Или воспользуйтесь файлом `install_requirements.bat`

Если не установлен ffmpeg, установите его. https://ffmpeg.org/download.html

## Использование

Настройки на клиентской стороне (Сервера СС13) зависят от кодбазы.

В общих чертах для подключения локального TTS задайте следующие настройки в конфигурации:

- `TTS_TOKEN` - токен подключения, не используется
- `TTS_URL` - строка подключения к серверу, например `http://127.0.0.1:5000/tts/`
- `TTS_ENABLED` - включена ли поддержка TTS на сервере
- `TTS_CACHE` - включен ли кэш TTS на сервере

Запустите `tts_server.py` через bat файл `launch_server.bat` или воспользуйтесь командной строкой и введите `python tts_server.py`.
Появившийся адрес можно вставить на место `TTS_URL`

Запустите сервер SS13

## Примечания

- Производительность разняется от компьютеру к компьютеру. Возможны задержки от 0.5 секунд.

Модели для Silero API поставляются https://github.com/snakers4/silero-models. 
Для коммерческого использования моделей из этого репозитория обратитесь к его автору.

Модели, поставляемые вышеуказанным репозиторием, содержат меньшее количество голосов, чем используемое на игровом сервере.
По умолчанию стоит мужской голос `aidar`
Если желаете поменять голос озвучки, в файле tts_server.py поменяйте значение primary_speaker на желаемое.
Уточняйте возможные голоса в самом репозитории.

Если хотите поменять модель, удалите или переместите файл `model.pt`, а в `tts_processor` заместо ссылки на модель в `torch.hub.download_url_to_file...`
поставьте желаемую ссылку.

Также вы можете скачать модель вручную и переименовать её в `model.pt`, ознакомьтесь с инструкциями в репозитории моделей.
